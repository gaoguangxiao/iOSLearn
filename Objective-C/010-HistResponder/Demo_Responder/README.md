# HitTest

一、基本概念

1、事件是什么？
事件是被发送到应用程序中反应用户操作的对象。

2、响应者链条是什么？
解决用户操作的事件的处理，事件传递的目的是找到一个能处理并响应事件的对象

3、如何查找能处理该事件的对象呢？
iPhone系统通过hit-testing过程逐级查找被触摸的视图，该过程会检查触摸点是否位于相关视图的范围之内。如果触摸点位于视图范围之内，则进一步对子视图执行检查过程，最终，触摸点所在的视图层级最底层的视图（界面角度来看是最上层的视图）将成为hit-test视图，此时iPhone操作系统会将触摸时间交给该视图进行处理。
能接受消息的是从view层级结构的父视图向子视图传递。即树状结构的根节点向叶子节点递归传递

4、在hit-test过程中，对于同级视图对象如何查找?
比如：视图上有两个子视图a和b,先查找哪一个子视图，iPhone操作系统遵循“基于同一层级的视图，后添加先被检查”的原则。直到检查的视图没有子视图，也就是当前的视图是界面的最表层视图（视图层级最底层的视图）。


5、响应者对象
UIResponder类及其子类的对象，都可以成为响应者对象，它们具有响应和处理事件的能力，CAlLayer集成自NSObject，不是响应者对象

6、事件处理路径？
从界面角度最上层的视图开始，如果不能响应，交由下一层级视图响应，
处理消息的是和查询的过程相反。
subView -> view -> ViewController -> window -> responder

7、hit-Test方法底层实现是什么？
a、hitTest方法内部会调用 pointInside，询问触摸点是否在自己身上，当遍历子控件的时候，传入的坐标需要进行转化，父视图坐标系转化为子视图坐标系 s.convert point fromView:self
b、当控件接收到触摸事件，不管能不能处理事件，都会执行hittest方法。

二、场景使用

5、改变触摸
如下图，点击黄色和红色区域，我想让红色响应，如何用代码处理？

改变响应者链条，由查询过程可知
1、首先查询父视图，判断红色是否在触摸区域内，查询红色的子视图，是否有能够响应的子视图去处理这个事件



触发一个事件 -> 创建包含事件信息的一个事件对象 -> 活跃的APP
uikit对象

